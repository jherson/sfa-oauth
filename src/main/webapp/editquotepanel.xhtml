<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

<rich:panel id="editQuotePanel" rendered="#{quoteForm.editMode}"
	style="border-color: #C27E3A; background-color: #FCF9F5; ">

	<f:facet name="header">
		<rich:toolbar height="16" itemSeparator="grid"
			style="border: 0; background-color: #FCF9F5;">

			<rich:toolbarGroup location="right">

				<a4j:commandLink value="#{msgs.save}"					
					action="#{quoteManager.saveQuote(quoteForm.selectedQuote)}"
					render="quoteList, :details" ajaxSingle="true" />

				<a4j:commandLink value="#{msgs.cancel}"
					immediate="true"
					action="#{quoteManager.cancelQuote(quoteForm.selectedQuote)}" 
					bypassUpdates="true"
					type="reset" render="details" ajaxSingle="true" execute="@this" />

			</rich:toolbarGroup>
		</rich:toolbar>
	</f:facet>

	<h:panelGrid styleClass="rf-dt" width="100%"
		style="background-color: #FCF9F5; 
		border-right-style: hidden; border-top-style: hidden; border-left-style: hidden; border-bottom-style: hidden;"
		columnClasses="label-column,column-l-align,label-column,column-l-align"
		columns="4">

		<h:outputText value="#{msgs.name}" />
		<h:inputText id="name" required="true"
			value="#{quoteForm.selectedQuote.name}" style="width:300px"
			rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote}"
			requiredMessage="#{msgs.quoteNameRequiredMessage}">
			<rich:validator />
		</h:inputText>

		<h:outputText value="#{quoteForm.selectedQuote.name}"
			rendered="#{quoteForm.opportunity.isClosed or empty quoteForm.selectedQuote}" />

		<h:outputText value="#{msgs.number}" />
		<h:outputText value="#{quoteForm.selectedQuote.number}" />

		<h:outputText value="#{msgs.type}" />
		<h:outputText value="#{quoteForm.selectedQuote.type}"
			rendered="#{quoteForm.opportunity.isClosed or empty quoteForm.selectedQuote or quoteForm.selectedQuote.id != null}" />
		<h:selectOneMenu value="#{quoteForm.selectedQuote.type}"
			rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote and quoteForm.selectedQuote.id == null}">
			<f:selectItem itemValue="Standard" />
			<f:selectItem itemValue="Co-Term" />
			<f:selectItem itemValue="Non Standard" />
		</h:selectOneMenu>

		<h:outputText value="#{msgs.version}" />
		<h:outputText value="#{quoteForm.selectedQuote.version}" />

		<h:outputText value="#{msgs.active}" />
		<h:panelGroup>
			<h:graphicImage value="./images/active.png"
				rendered="#{quoteForm.selectedQuote.isActive}" />
		</h:panelGroup>

		<h:outputText value="#{msgs.currency}" />
		<h:outputText value="#{quoteForm.selectedQuote.currencyIsoCode}"
			rendered="#{quoteForm.opportunity.isClosed or empty quoteForm.selectedQuote or quoteForm.selectedQuote.id != null}" />
		<h:selectOneMenu value="#{quoteForm.selectedQuote.currencyIsoCode}"
			rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote and quoteForm.selectedQuote.id == null}">
			<f:selectItem itemValue="USD" />
			<f:selectItem itemValue="EUR" />
			<f:selectItem itemValue="GBP" />
		</h:selectOneMenu>

		<h:outputText value="#{msgs.payNow}" />
		<h:selectOneMenu value="#{quoteForm.selectedQuote.payNow}"
			rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote}">
			<f:selectItem itemValue="Yes" />
			<f:selectItem itemValue="No" />
		</h:selectOneMenu>
		<h:outputText value="#{quoteForm.selectedQuote.payNow}"
			rendered="#{quoteForm.opportunity.isClosed or empty quoteForm.selectedQuote}" />

		<h:outputText value="#{msgs.amount}" />
		<h:outputText value="#{quoteForm.selectedQuote.amount}">
			<f:convertNumber locale="#{sforceSession.sessionUser.locale}"
				pattern="#,##0.00;(#,##0.00)"></f:convertNumber>
		</h:outputText>

		<h:outputText value="#{msgs.owner}" />
		<h:panelGroup>
			<h:outputText id="ownerName"
				value="#{quoteForm.selectedQuote.ownerName}" />

			<h:outputText value=" " />

			<a4j:commandLink id="changeOwner"
				oncomplete="#{rich:component('ownerPanel')}.show()"
				action="#{quoteManager.editQuote(quoteForm.selectedQuote)}"
				rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote}"
				rerender="#{rich:clientId('ownerPanel')}" ajaxSingle="true">

				<h:graphicImage value="./images/search.png" title="#{msgs.change}" />

			</a4j:commandLink>

		</h:panelGroup>

		<h:outputText value="#{msgs.contact}" />
		<h:panelGroup>
			<h:outputText value="#{quoteForm.selectedQuote.contactName}" />

			<h:outputText value=" " />

			<a4j:commandLink id="changeContact"
				oncomplete="#{rich:component('contactPanel')}.show()"
				action="#{quoteManager.editQuote(quoteForm.selectedQuote)}"
				rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote}"
				reRender="#{rich:clientId('contactPanel')}" ajaxSingle="true">

				<h:graphicImage value="./images/search.png" title="#{msgs.change}" />

			</a4j:commandLink>

		</h:panelGroup>

		<h:outputText value="#{msgs.effectiveDate}" />
		<h:panelGroup>
			<h:outputText value="#{quoteForm.selectedQuote.effectiveDate}"
				rendered="#{quoteForm.opportunity.isClosed or empty quoteForm.selectedQuote}" />

			<rich:calendar value="#{quoteForm.selectedQuote.effectiveDate}"
				id="effectiveDate" locale="#{sforceSession.sessionUser.locale}"
				popup="true"
				datePattern="#{sforceSession.sessionUser.dateFormatPattern}"
				showApplyButton="false" cellWidth="24px" cellHeight="22px"
				style="width:200px"
				rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote}"
				disabled="false">
			</rich:calendar>

		</h:panelGroup>

		<h:outputText value="#{msgs.expirationDate}" />
		<h:panelGroup>
			<h:outputText value="#{quoteForm.selectedQuote.expirationDate}"
				rendered="#{quoteForm.opportunity.isClosed or empty quoteForm.selectedQuote}" />

			<rich:calendar value="#{quoteForm.selectedQuote.expirationDate}"
				id="expirationDate" locale="#{sforceSession.sessionUser.locale}"
				popup="true"
				datePattern="#{sforceSession.sessionUser.dateFormatPattern}"
				showApplyButton="false" cellWidth="24px" cellHeight="22px"
				style="width:200px"
				rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote}"
				disabled="false">
			</rich:calendar>
		</h:panelGroup>

		<h:outputText value="#{msgs.referenceNumber}" />
		<h:outputText value="#{quoteForm.selectedQuote.referenceNumber}"
			rendered="#{quoteForm.opportunity.isClosed or empty quoteForm.selectedQuote}" />
		<h:inputText value="#{quoteForm.selectedQuote.referenceNumber}"
			rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote}" />

		<h:outputText value=" "
			rendered="#{empty quoteForm.selectedQuote or quoteForm.selectedQuote.type == 'Non Standard'}" />
		<h:outputText value=" "
			rendered="#{empty quoteForm.selectedQuote or quoteForm.selectedQuote.type == 'Non Standard'}" />

		<h:outputText value="#{msgs.term}"
			rendered="#{quoteForm.selectedQuote.type == 'Standard'}" />
		<h:panelGroup rendered="#{quoteForm.selectedQuote.type == 'Standard'}">
			<h:outputText value="#{quoteForm.selectedQuote.term}"
				rendered="#{quoteForm.opportunity.isClosed or empty quoteForm.selectedQuote}" />
			<h:selectOneMenu value="#{quoteForm.selectedQuote.term}"
				rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote}">
				<f:selectItem itemLabel="1" itemValue="365" />
				<f:selectItem itemLabel="3" itemValue="1095" />
			</h:selectOneMenu>	
			<h:outputText value="#{msgs.startDate}" />		
			<h:outputText value="#{quoteForm.selectedQuote.startDate}"
				rendered="#{quoteForm.opportunity.isClosed or empty quoteForm.selectedQuote}" />
			<rich:calendar value="#{quoteForm.selectedQuote.startDate}"
				id="startDate" locale="#{sforceSession.sessionUser.locale}"
				popup="true"
				datePattern="#{sforceSession.sessionUser.dateFormatPattern}"
				showApplyButton="false" cellWidth="24px" cellHeight="22px"
				style="width:200px"
				rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote}"
				disabled="false">
			</rich:calendar>
			
		</h:panelGroup>

		<h:outputText value="#{msgs.endDate}"
			rendered="#{quoteForm.selectedQuote.type == 'Co-Term'}" />
		<h:panelGroup rendered="#{quoteForm.selectedQuote.type == 'Co-Term'}">
			<h:outputText value="#{quoteForm.selectedQuote.endDate}"
				rendered="#{quoteForm.opportunity.isClosed or empty quoteForm.selectedQuote}" />
			<rich:calendar value="#{quoteForm.selectedQuote.endDate}"
				id="endDate" locale="#{sforceSession.sessionUser.locale}"
				popup="true"
				datePattern="#{sforceSession.sessionUser.dateFormatPattern}"
				showApplyButton="false" cellWidth="24px" cellHeight="22px"
				style="width:200px"
				rendered="#{not quoteForm.opportunity.isClosed and not empty quoteForm.selectedQuote}"
				disabled="false">
			</rich:calendar>
		</h:panelGroup>

	</h:panelGrid>

	<br />
	
	<ui:include src="viewpriceadjustments.xhtml" />
	
	<br />

	<ui:include src="editquoteproducts.xhtml" />


</rich:panel>
</html>