<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	template="/WEB-INF/templates/default.xhtml">

	<ui:define name="header">

		<div id="header-left">

			<div class="header-cell">
				<h:graphicImage id="logo" alt="logo"
					url="/resources/images/logo.png" />
			</div>

			<div class="header-cell">
				<h:outputText value="#{msgs.apptitle}"
					style="font: bold 20px liberation,serif; text-decoration: none; color: black" />
			</div>

			<div class="header-cell">
				<h:inputText style="width: 300px; height: 18px;"
					rendered="#{sessionManager.loggedIn}" />
			</div>

			<div class="header-cell">
				<a4j:commandButton value="#{msgs.search}" styleClass="commandButton"
					rendered="#{sessionManager.loggedIn}" />
			</div>

		</div>

		<div id="header-right">

			<ui:include src="/WEB-INF/pages/profile.xhtml" />

			<div class="header-cell">
				<a4j:commandLink
					value="#{sessionUser.name} (#{sessionUser.profileName})"
					rendered="#{sessionManager.loggedIn}"
					style="color:#{a4jSkin.generalTextColor}; text-decoration: none; font-size: 14px;"
					oncomplete="#{rich:component('profilePanel')}.show()"
					status="waitstatus" rerender="#{rich:clientId('profilePanel')}"
					ajaxSingle="true">
				</a4j:commandLink>
			</div>

			<div class="header-cell">
				<a4j:commandLink rendered="#{sessionManager.loggedIn}"
					oncomplete="#{rich:component('profilePanel')}.show()"
					status="waitstatus" rerender="#{rich:clientId('profilePanel')}"
					ajaxSingle="true">
					<h:graphicImage
						value="#{sessionUser.smallPhotoUrl}?oauth_token=#{sessionUser.OAuth.accessToken}"
						height="40" width="40">
					</h:graphicImage>
				</a4j:commandLink>
			</div>

			<div class="header-cell">
				<a4j:commandLink value="#{msgs.logout}"
					style="color:#{a4jSkin.generalTextColor}; text-decoration: none; font-size: 14px;"
					render="quoteForm" rendered="#{sessionManager.loggedIn}"
					action="#{sessionManager.logout()}">
				</a4j:commandLink>

				<a4j:commandLink value="#{msgs.login}"
					style="color:#{a4jSkin.generalTextColor}; text-decoration: none; font-size: 14px;"
					render="quoteForm" rendered="#{not sessionManager.loggedIn}"
					action="#{sessionManager.login()}">
				</a4j:commandLink>
			</div>

		</div>

		<div style="clear: both;" />

	</ui:define>

	<ui:define name="sidebar">

		<h:panelGroup layout="block" style="padding: 20px 15px 5px 15px;">

			<h:panelGroup layout="block" style="padding: 5px;">

				<a4j:commandLink id="homeLink" rendered="#{sessionManager.loggedIn}"
					status="waitstatus">
					<a4j:ajax render="mainArea" execute="@this" event="click" />
					<f:param name="pageView" value="home" />
					<a4j:actionListener listener="#{homeController.showPageView}" />

					<h:graphicImage id="home" alt="home"
						url="/images/menubar/home48x48.png" />

				</a4j:commandLink>

			</h:panelGroup>

			<h:panelGroup layout="block" style="padding: 5px;">

				<a4j:commandLink id="quotemanagerLink"
					rendered="#{sessionManager.loggedIn}" status="waitstatus">
					<a4j:ajax render="mainArea" execute="@this" event="click" />
					<f:param name="pageView" value="quotemanager" />
					<a4j:actionListener listener="#{homeController.showPageView}" />

					<h:graphicImage id="quotemanager" alt="quotemanager"
						url="/images/menubar/quote48x48.png" />

				</a4j:commandLink>

			</h:panelGroup>

		</h:panelGroup>

	</ui:define>

	<ui:define name="body">

		<h:panelGroup id="mainArea">
		
			<h:panelGroup layout="block" id="messagePanel" ajaxRendered="true"
				style="border-color: red; padding: 5px;"
				render="#{facesContext.maximumSeverity != null}">
				<rich:messages />
			</h:panelGroup>

			<ui:include src="#{sessionManager.mainArea.template}" />
			
		</h:panelGroup>

	</ui:define>

</ui:composition>