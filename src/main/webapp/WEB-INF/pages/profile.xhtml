<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j">

	<rich:popupPanel id="profilePanel" modal="true" autosized="true"
		resizeable="false" width="400" height="250">

		<f:facet name="header">
			<h:outputText value="#{msgs.profile}" />
		</f:facet>
		<f:facet name="controls">
			<a4j:commandLink status="waitStatus">
				<h:graphicImage value="/resources/images/close-window.png"
					alt="close-window" />
				<rich:componentControl target="profilePanel" operation="hide" />		
			</a4j:commandLink>
		</f:facet>

		<a4j:outputPanel>

			<h:panelGrid width="100%" columns="2" cellpadding="3"
				layout="inline-block">

				<h:panelGroup>

					<h:graphicImage
						value="#{sessionUser.fullPhotoUrl}?oauth_token=#{sessionUser.OAuth.accessToken}"
						height="160" width="160" />

				</h:panelGroup>

				<h:panelGroup>

					<table style="width: 100%">
						<tr>
							<td width="200"><a4j:commandLink value="#{sessionUser.name}"
									onclick="window.open('#{urlBuilder.profile}');">
									<rich:componentControl target="profilePanel" operation="hide" />
								</a4j:commandLink></td>
						</tr>
						<tr>
							<td width="200">#{sessionUser.profile.name}</td>
						</tr>
						<tr>
							<td width="200">#{sessionUser.title}</td>
						</tr>
						<tr>
							<td width="200">#{sessionUser.email}</td>
						</tr>
						<tr>
							<td width="200">#{sessionUser.phone}
								#{sessionUser.extension}</td>
						</tr>
						<tr>
							<td width="200">#{sessionUser.street}</td>
						</tr>
						<tr>
							<td width="200">#{sessionUser.city}, #{sessionUser.state}
								#{sessionUser.postalCode}</td>
						</tr>
					</table>

				</h:panelGroup>

			</h:panelGrid>

			<br />

			<h:panelGroup style="display: block; text-align: right">

				<a4j:commandButton value="#{msgs.preferences}"
					styleClass="commandButton"
					action="#{homeController.showPreferences}" render="mainArea"
					onclick="#{rich:component('profilePanel')}.hide(); return true;">					
				</a4j:commandButton>

				<h:outputText value="  " escape="false" />

				<a4j:commandButton value="#{msgs.salesforceHome}"
					styleClass="commandButton"
					onclick="window.open('#{urlBuilder.home}');">
					<rich:componentControl target="profilePanel" operation="hide" />
				</a4j:commandButton>

				<h:outputText value="  " escape="false" />

				<a4j:commandButton value="#{msgs.close}" styleClass="commandButton"
					status="waitStatus">
					<rich:componentControl target="profilePanel" operation="hide" />
				</a4j:commandButton>

			</h:panelGroup>

		</a4j:outputPanel>


	</rich:popupPanel>

</ui:composition>