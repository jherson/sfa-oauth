<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j">

	<rich:extendedDataTable id="quoteListDataTable" var="quote"
		style="height:600px;" value="#{quoteList}"
		noDataLabel="#{msgs.noRecords}" iterationStatusVar="it"
		selectionMode="single">

		<rich:column width="80px">
			<f:facet name="header">#{msgs.action}</f:facet>

			<h:panelGroup>

				<a4j:commandLink id="editQuote"
				    value="#{msgs.edit}"
					ajaxSingle="true" >
					<f:attribute name="quote" value="#{quote}" />
				    <a4j:ajax execute="@this" event="click"
					    listener="#{quoteManagerController.editQuote}"
					    render="mainArea">
				    </a4j:ajax>
				</a4j:commandLink>

				<h:outputText value="   " />

				<a4j:commandLink id="deleteQuote" 
				    value="#{msgs.delete}"
				    rendered="#{not quote.isActive}"
					onclick="if (! window.confirm('#{msgs.confirmDelete}')) { return false };" >
					<f:attribute name="quote" value="#{quote}" />
				    <a4j:ajax execute="@this" event="click"
					    listener="#{quoteManagerController.deleteQuote}"
					    render="quoteListDataTable">
				    </a4j:ajax>
				</a4j:commandLink>

				<h:outputText value="   " />

			</h:panelGroup>

		</rich:column>

		<rich:column width="80px" style="text-align: center;">
			<f:facet name="header">#{msgs.number}</f:facet>
			<a4j:commandLink value="#{quote.number}"
				actionListener="#{homeController.viewQuote}"
				ajaxSingle="true" execute="@this" render="mainArea">
				<f:attribute name="quoteId" value="#{quote.id}" />
			</a4j:commandLink>
		</rich:column>

		<rich:column width="350px">
			<f:facet name="header">#{msgs.name}</f:facet>
			<h:outputText value="#{quote.quoteName}" />
		</rich:column>

		<rich:column width="80px">
			<f:facet name="header">#{msgs.type}</f:facet>
			<h:outputText value="#{quote.type}" />
		</rich:column>

		<rich:column width="350px">
			<f:facet name="header">#{msgs.opportunity}</f:facet>
			<a4j:commandLink value="#{quote.opportunity.name}">
				<f:attribute name="quote" value="#{quote}" />
				<a4j:ajax execute="@this" event="click"
					listener="#{quoteManagerController.viewOpportunity}"
					render="mainArea">
				</a4j:ajax>
			</a4j:commandLink>
		</rich:column>

		<rich:column width="80px" style="text-align: center;">
			<f:facet name="header">#{msgs.active}</f:facet>
			<h:graphicImage value="./images/active.png" styleClass="centered"
				style="vertical-align: middle;" rendered="#{quote.isActive}" />
		</rich:column>

		<rich:column width="100px">
			<f:facet name="header">#{msgs.amount} </f:facet>
			<h:outputText value="#{quote.currencyIsoCode}" />
			<h:outputText value="  " escape="false" />
			<h:outputText value="#{quote.amount}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)"></f:convertNumber>
			</h:outputText>
		</rich:column>

		<rich:column width="100px" style="text-align: center;">
			<f:facet name="header">#{msgs.status}</f:facet>
			<h:outputText value="#{quote.status}" />
		</rich:column>

	</rich:extendedDataTable>
</ui:composition>