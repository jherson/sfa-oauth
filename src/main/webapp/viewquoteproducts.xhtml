<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">
	
<h:outputStylesheet>
	.panel-body {
        color: #000000;
        font-family: Arial,Verdana,sans-serif;
        font-size: 11px;
        padding: 0px;
    }
</h:outputStylesheet>	


<rich:panel id="viewQuoteProducts"
	style="border: 0px; border-color: #C27E3A; background-color: #FCF9F5;"
	bodyClass="panel-body">

	<rich:toolbar height="18" itemSeparator="grid">

		<rich:toolbarGroup location="left">

			<a4j:commandLink value="#{msgs.delete}"
				rendered="#{quoteForm.editMode}"
				action="#{quoteController.deleteQuoteLineItems()}"
				disabled="#{empty quoteController.selectedQuote.quoteLineItems}"
				render="quoteList, details" ajaxSingle="true" >
			</a4j:commandLink>

			<a4j:commandLink value="#{msgs.reset}" immediate="true"
				rendered="#{quoteForm.editMode}" status="ajaxStatus"
				disabled="#{empty quoteController.selectedQuote.quoteLineItems}"
				action="#{quoteController.reset()}"
				render="details" ajaxSingle="true" >				
			</a4j:commandLink>

		</rich:toolbarGroup>

		<rich:toolbarGroup location="right">
		
		    <a4j:commandLink id="addOpportunityProducts" value="#{msgs.addOpportunityProducts}"
				rendered="#{not quoteForm.editMode and quoteController.selectedQuote.currencyIsoCode == quoteController.opportunity.currencyIsoCode}"
				disabled="#{empty quoteController.opportunity.opportunityLineItems}"								 			
                action="#{quoteController.viewOpportunityLineItems()}"
                render="mainArea" status="ajaxStatus" />
				
			<a4j:commandLink value="#{msgs.addProduct}"
				rendered="#{quoteForm.editMode}"
				action="#{quoteController.newQuoteLineItem()}"
				render="quoteList, details" ajaxSingle="true"		
				status="ajaxStatus"/>

		</rich:toolbarGroup>

	</rich:toolbar>

	<rich:dataTable id="quoteProductsTable" style="width: 100%" var="lineItem"
		noDataLabel="#{msgs.noRecords}"
		iterationStatusVar="it"
		status="ajaxStatus"
		value="#{quoteController.selectedQuote.quoteLineItems}">

		<rich:column style="text-align: center; width: 3%;">
			<f:facet name="header">#{msgs.select}</f:facet>
			<h:outputText value="#{it.index}" 
			    rendered="#{not quoteForm.editMode}" />
			<h:selectBooleanCheckbox value="#{lineItem.delete}" 
			    rendered="#{quoteForm.editMode}"/>
		</rich:column>

		<rich:column style="text-align: center; width: 7%;">
			<f:facet name="header">#{msgs.productCode}</f:facet>
			<h:outputText value="#{lineItem.product.productCode}"
				rendered="#{not quoteForm.editMode}" />
			<h:inputText id="productCode" value="#{lineItem.product.productCode}"
				style="width: 75px;" rendered="#{quoteForm.editMode}"		
				execute="immediate" ajaxSingle="true">				
				<f:attribute name="rowIndex" value="#{it.index}"/>
				<a4j:ajax execute="@this" event="valueChange"
					listener="#{quoteLineItemListDataTableBean.validateProduct}" render="viewQuoteProducts">					  
				</a4j:ajax>

			</h:inputText>
			<rich:message for="productCode" />

		</rich:column>

		<rich:column style="text-align: center; width: 7%;">
			<f:facet name="header">#{msgs.configuredSku}</f:facet>
			<h:outputText value="#{lineItem.configuredSku}" />
		</rich:column>

		<rich:column>
			<f:facet name="header">#{msgs.description}</f:facet>
			<h:outputText value="#{lineItem.product.description}" />
		</rich:column>

		<rich:column style="text-align: center; width: 8%;">
			<f:facet name="header">#{msgs.startDate}</f:facet>
			<h:outputText value="#{lineItem.startDate}"
				rendered="#{not quoteForm.editMode or quoteController.selectedQuote.type == 'Standard'}">
				<f:convertDateTime locale="#{sessionUser.locale}"
					pattern="#{sessionUser.dateFormatPattern}"
					type="date" />
			</h:outputText>
			<rich:calendar value="#{lineItem.startDate}"
				rendered="#{quoteForm.editMode and quoteController.selectedQuote.type != 'Standard'}"
				id="lineStartDate" locale="#{sessionUser.locale}"
				popup="true" enableManualInput="true"
				datePattern="#{sessionUser.dateFormatPattern}"
				showApplyButton="false" cellWidth="24px" cellHeight="22px"
				inputStyle="width:68px" disabled="false">
			</rich:calendar>
		</rich:column>

		<rich:column style="text-align: center; width: 8%;">
			<f:facet name="header">#{msgs.endDate}</f:facet>
			<h:outputText value="#{lineItem.endDate}"
				rendered="#{not quoteForm.editMode or quoteController.selectedQuote.type != 'Non Standard'}">
				<f:convertDateTime locale="#{sessionUser.locale}"
					pattern="#{sessionUser.dateFormatPattern}"
					type="date" />
			</h:outputText>
			<rich:calendar value="#{lineItem.endDate}"
				rendered="#{quoteForm.editMode and quoteController.selectedQuote.type == 'Non Standard'}"
				id="lineEndDate" locale="#{sessionUser.locale}"
				popup="true" enableManualInput="true"
				datePattern="#{sessionUser.dateFormatPattern}"
				showApplyButton="false" cellWidth="24px" cellHeight="22px"
				inputStyle="width:68px" disabled="false">
			</rich:calendar>
		</rich:column>

		<rich:column style="text-align: right; width: 5%;">
			<f:facet name="header">#{msgs.quantity}</f:facet>
			<h:outputText value="#{lineItem.quantity}"
				rendered="#{not quoteForm.editMode}" />
			<h:inputText value="#{lineItem.quantity}" style="width: 50px;"
				rendered="#{quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0;(#,##0)" type="number" />
			</h:inputText>
		</rich:column>

		<rich:column style="text-align: right; width: 6%;">
			<f:facet name="header">#{msgs.listPrice}</f:facet>
			<h:outputText value="#{lineItem.listPrice}"
				rendered="#{not quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" />
			</h:outputText>
			<h:inputText value="#{lineItem.listPrice}" style="width: 70px;"
				rendered="#{quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" type="number" />
			</h:inputText>
		</rich:column>

		<rich:column style="text-align: right; width: 4%;">
			<f:facet name="header">#{msgs.discountPercent}</f:facet>
			<h:outputText value="#{lineItem.discountPercent}"
				rendered="#{not quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" />
			</h:outputText>
			<h:inputText value="#{lineItem.discountPercent}" style="width: 70px;"
				rendered="#{quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" type="number" />
			</h:inputText>
		</rich:column>

		<rich:column style="text-align: right; width: 4%;">
			<f:facet name="header">#{msgs.discountAmount}</f:facet>
			<h:outputText value="#{lineItem.discountAmount}"
				rendered="#{not quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" />
			</h:outputText>
			<h:inputText value="#{lineItem.discountAmount}" style="width: 70px;"
				rendered="#{quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" type="number" />
			</h:inputText>
		</rich:column>

		<rich:column style="text-align: right; width: 6%;">
			<f:facet name="header">#{msgs.salesPrice}</f:facet>
			<h:outputText value="#{lineItem.yearlySalesPrice}"
				rendered="#{not quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" />
			</h:outputText>
			<h:inputText value="#{lineItem.yearlySalesPrice}"
				style="width: 70px;" rendered="#{quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" type="number" />
			</h:inputText>
		</rich:column>

		<rich:column style="text-align: right; width: 6%;">
			<f:facet name="header">#{msgs.unitPrice}</f:facet>
			<h:outputText value="#{lineItem.unitPrice}"
				rendered="#{not quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" />
			</h:outputText>
			<h:inputText value="#{lineItem.unitPrice}" style="width: 70px;"
				rendered="#{quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" type="number" />
			</h:inputText>
		</rich:column>

		<rich:column style="text-align: right; width: 6%;">
			<f:facet name="header">#{msgs.totalPrice}</f:facet>
			<h:outputText value="#{lineItem.totalPrice}"
				rendered="#{not quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" />
			</h:outputText>
			<h:inputText value="#{lineItem.totalPrice}" style="width: 78px;"
				rendered="#{quoteForm.editMode}">
				<f:convertNumber locale="#{sessionUser.locale}"
					pattern="#,##0.00;(#,##0.00)" type="number" />
			</h:inputText>
		</rich:column>

	</rich:dataTable>
</rich:panel>
</html>